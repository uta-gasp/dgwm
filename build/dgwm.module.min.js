module.exports=function(t){function n(e){if(i[e])return i[e].exports;var o=i[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var i={};return n.m=t,n.c=i,n.i=function(t){return t},n.d=function(t,i,e){n.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:e})},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=5)}([function(t,n,i){"use strict";function e(t,n){this.id=Symbol(n),this._record=[],this.level=0,this.generalPadding="";for(var i=0;i<a.size;i+=1)this.generalPadding+=e.padding;a.set(this.id,this),r.enabled&&(console.log(""+this.generalPadding+t),n&&console.log(e.padding+this.generalPadding+n))}var o=arguments,r={enabled:!1};r.moduleErrorPrinter=function(t){return void 0!==(void 0).Reading?function(){}:function(t){console.error('Missing "${missingService}" service for "${moduleName}"')}},r.moduleLogPrinter=function(t){var n=function(t){console.log(t)};return void 0!==(void 0).Reading?function(){}:function(i){if(r.enabled){console.log("\n",t),console.log(i);for(var e=1;e<o.length;e+=1){var a=o[e];void 0!==a&&(a instanceof Array?a.forEach(n):console.log(a))}}}},r.forModule=function(t){return{start:function(n){return new e(t,n)},end:function(t){a.delete(t.id)},log:function(){var n;r.enabled&&(n=console).log.apply(n,[t].concat(Array.prototype.slice.call(arguments)))}}},e.padding="    ",e.prototype.push=function(){for(var t="",n=0;n<this.level;n+=1)t+=e.padding;r.enabled&&console.log(e.padding+this.generalPadding+t+Array.prototype.join.call(arguments," "))},e.prototype.levelUp=function(t){void 0!==t&&this.push(t),this.level+=1},e.prototype.levelDown=function(){this.level-=1,this.level<0&&(this.level=0)},e.prototype.notEmpty=function(){return this._record.length>0},e.prototype.print=function(){r.enabled&&console.log(e.padding+this.generalPadding+this._record.join("\n"+e.padding))};var a=new Map;t.exports=r},function(t,n,i){"use strict";function e(t,n,i,e,o){this.left=Number.MAX_VALUE,this.top=Number.MAX_VALUE,this.right=Number.MIN_VALUE,this.bottom=Number.MIN_VALUE,this.center=void 0,this.index=e||0,this.previous=o||null,this.next=null,this.previous&&(this.previous.next=this),this.fixations=[],this.fitEq=null,this.words=[],t&&this.add(t,n,i)}function o(t,n){for(var i=0,e=0;e<t.length;++e){var o=t[e];i+=o[1]-n*o[0]}return[i/t.length,n]}function r(t,n,i,e){this.rect=t,this.id=n,this.dom=i,this.line=e,this.index=e.words.length}var a=i(4),u=i(0);e.init=function(t){d=u.forModule("Line"),t=t||{},l=t.modelMaxGradient||.15,s=t.modelTypeSwitchThreshold||8,h=t.modelRemoveOldFixThreshold||10},e.prototype.width=function(){return this.right-this.left},e.prototype.add=function(t,n,i){this.left=Math.min(this.left,t.left),this.right=Math.max(this.right,t.right),this.top=Math.min(this.top,t.top),this.bottom=Math.max(this.bottom,t.bottom),this.center={x:(this.left+this.right)/2,y:(this.top+this.bottom)/2},this.words.push(new r(t,n,i,this))},e.prototype.addFixation=function(t){if(this.fixations.push([t.x,t.y,t.saccade]),f=d.start(),this.fixations.length>1){this._removeOldFixation();var n=this.fixations.length<s?"linear":"polynomial",i=a.model(n,this.fixations,2);this.fitEq=i.equation,f.push("model for line",this.index,":",this.fitEq),"linear"===n&&(this.fitEq[1]<-l?(this.fitEq=o(this.fixations,-l),f.push("model reset to",this.fitEq)):this.fitEq[1]>l&&(this.fitEq=o(this.fixations,l),f.push("model reset to",this.fitEq)))}d.end(f)},e.prototype.fit=function(t,n){if(this.fitEq){var i=n-a.fit(this.fitEq,t),e=d.start();return e.push("e[",this.index,"|",t,n,"] =",Math.floor(i)),d.end(e),i}return Number.MAX_VALUE},e.prototype._removeOldFixation=function(){var t=this.fixations.length-1;if(!(t<5))for(var n=t,i=void 0;n>0;){if(i=this.fixations[n],n>0&&i[2].newLine){t-n+1>h&&(this.fixations=this.fixations.slice(n),f.push("line fixations: reduced"));break}n-=1}};var l=void 0,s=void 0,h=void 0,d=void 0,f=void 0;r.prototype.toString=function(){return this.rect.left+","+this.rect.top+" / "+this.line.index},t.exports={Line:e,Word:r}},function(t,n,i){"use strict";function e(t,n){var i=t-c.x,e=n-c.y,o=void 0;if(Math.sqrt(i*i+e*e)>s)null===p?(p=new r(t,n,h),p.previous=c,p.saccade=new a(t-c.x,n-c.y),c.next=p):(p.x=d*t+v*p.x,p.y=d*n+v*p.y,p.duration+=h,c=p,p=null);else{p=null;var u=c.duration;c.duration+=h,c.x=d*c.x+v*t,c.y=d*c.y+v*n,u<l&&c.duration>=l&&(o=c)}return o}function o(t){var n=void 0;if(t.duration<l)return n;if(c.duration>t.duration){var i=new r(t.x,t.y,t.duration);i.previous=c,c.next=i;var e=t.saccade;i.saccade=e?new a(e.dx,e.dy):new a(t.x-c.x,t.y-c.y),c=i,f.push(c),n=c}else c.duration=t.duration,c.x=t.x,c.y=t.y;return n}function r(t,n,i){this.x=t,this.y=n,this.duration=i,this.saccade=null,this.word=null,this.previous=null,this.next=null}function a(t,n){this.x=t,this.y=n,this.newLine=!1}var u={init:function(t){t=t||{},l=t.minDuration||80,s=t.threshold||70,h=t.sampleDuration||33,d=t.filterDemph||.4,v=1-d,c=new r(-1e4,-1e4,Number.MAX_VALUE),c.saccade=new a(0,0)},feed:function(t,n){return void 0!==n?e(t,n):o(t)},add:function(t,n,i){if(i<l)return null;var e=new r(t,n,i);return e.previous=c,c.next=e,e.saccade=new a(t-c.x,n-c.y),c=e},reset:function(){f.length=0,c=new r(-1e4,-1e4,Number.MAX_VALUE),c.saccade=new a(0,0),p=null},current:function(){return c}},l=void 0,s=void 0,h=void 0,d=void 0,f=[],c=void 0,p=null,v=void 0;r.prototype.toString=function(){return"FIX "+this.x+","+this.y+" / "+this.duration+"ms SACC=["+this.saccade+"], WORD=["+this.word+"]"},a.prototype.toString=function(){return this.x+","+this.y+" / "+this.zone+(this.newLine?", new line":"")},t.exports={Detector:u,Fixation:r,Saccade:a}},function(t,n,i){"use strict";function e(t){for(var n=0,i=null,e=0;e<t.length;e+=1){var o=t[e],a=o.getBoundingClientRect();n<a.top||!i?(i&&(s+=a.top-i.top,h+=i.bottom-i.top,d<i.right-i.left&&(d=i.right-i.left)),i=new r(a,e,o,l.length,l[l.length-1]),l.push(i),n=a.top):i.add(a,e,o)}if(i&&(h+=i.bottom-i.top,h/=l.length,d<i.right-i.left&&(d=i.right-i.left)),l.length>1)s/=l.length-1;else if(l.length>0){var u=l[0];s=2*(u.bottom-u.top)}var c=f.start(l.length+" lines");f.end(c)}var o=i(0),r=i(1).Line,a={init:function(t){t=t||{},u=t.isTextFixed||!0,f=o.forModule("TextModel")},create:function(t){return u&&l.length>0?null:(this.reset(),e(t),this.model())},reset:function(){l=[],s=0,h=0,d=0},model:function(){return{lines:l,lineSpacing:s,lineHeight:h,lineWidth:d}}},u=void 0,l=[],s=void 0,h=void 0,d=void 0,f=void 0;t.exports=a},function(t,n,i){"use strict";!function(){var n=function(t,n){var i=0,e=0,o=0,r=0,a=0,u=t.length-1,l=Array(n);for(i=0;i<u;i++){for(r=i,e=i+1;e<u;e++)Math.abs(t[i][e])>Math.abs(t[i][r])&&(r=e);for(o=i;o<u+1;o++)a=t[o][i],t[o][i]=t[o][r],t[o][r]=a;for(e=i+1;e<u;e++)for(o=u;o>=i;o--)t[o][e]-=t[o][i]*t[i][e]/t[i][i]}for(e=u-1;e>=0;e--){for(a=0,o=e+1;o<u;o++)a+=t[o][e]*l[o];l[e]=(t[u][e]-a)/t[e][e]}return l},i={linear:function(t){for(var n=[0,0,0,0,0],i=0,e=[];i<t.length;i++)null!=t[i][1]&&(n[0]+=t[i][0],n[1]+=t[i][1],n[2]+=t[i][0]*t[i][0],n[3]+=t[i][0]*t[i][1],n[4]+=t[i][1]*t[i][1]);for(var o=(i*n[3]-n[0]*n[1])/(i*n[2]-n[0]*n[0]),r=n[1]/i-o*n[0]/i,a=0,u=t.length;a<u;a++){var l=[t[a][0],t[a][0]*o+r];e.push(l)}return{equation:[r,o],points:e,string:"y = "+Math.round(100*o)/100+"x + "+Math.round(100*r)/100}},linearThroughOrigin:function(t){for(var n=[0,0],i=0,e=[];i<t.length;i++)null!=t[i][1]&&(n[0]+=t[i][0]*t[i][0],n[1]+=t[i][0]*t[i][1]);for(var o=n[1]/n[0],r=0,a=t.length;r<a;r++){var u=[t[r][0],t[r][0]*o];e.push(u)}return{equation:[0,o],points:e,string:"y = "+Math.round(100*o)/100+"x"}},exponential:function(t){var n=[0,0,0,0,0,0],i=0,e=[];for(l=t.length;i<l;i++)null!=t[i][1]&&(n[0]+=t[i][0],n[1]+=t[i][1],n[2]+=t[i][0]*t[i][0]*t[i][1],n[3]+=t[i][1]*Math.log(t[i][1]),n[4]+=t[i][0]*t[i][1]*Math.log(t[i][1]),n[5]+=t[i][0]*t[i][1]);for(var o=n[1]*n[2]-n[5]*n[5],r=Math.pow(Math.E,(n[2]*n[3]-n[5]*n[4])/o),a=(n[1]*n[4]-n[5]*n[3])/o,u=0,l=t.length;u<l;u++){var s=[t[u][0],r*Math.pow(Math.E,a*t[u][0])];e.push(s)}return{equation:[r,a],points:e,string:"y = "+Math.round(100*r)/100+"e^("+Math.round(100*a)/100+"x)"}},logarithmic:function(t){var n=[0,0,0,0],i=0,e=[];for(u=t.length;i<u;i++)null!=t[i][1]&&(n[0]+=Math.log(t[i][0]),n[1]+=t[i][1]*Math.log(t[i][0]),n[2]+=t[i][1],n[3]+=Math.pow(Math.log(t[i][0]),2));for(var o=(i*n[1]-n[2]*n[0])/(i*n[3]-n[0]*n[0]),r=(n[2]-o*n[0])/i,a=0,u=t.length;a<u;a++){var l=[t[a][0],r+o*Math.log(t[a][0])];e.push(l)}return{equation:[r,o],points:e,string:"y = "+Math.round(100*r)/100+" + "+Math.round(100*o)/100+" ln(x)"}},power:function(t){var n=[0,0,0,0],i=0,e=[];for(u=t.length;i<u;i++)null!=t[i][1]&&(n[0]+=Math.log(t[i][0]),n[1]+=Math.log(t[i][1])*Math.log(t[i][0]),n[2]+=Math.log(t[i][1]),n[3]+=Math.pow(Math.log(t[i][0]),2));for(var o=(i*n[1]-n[2]*n[0])/(i*n[3]-n[0]*n[0]),r=Math.pow(Math.E,(n[2]-o*n[0])/i),a=0,u=t.length;a<u;a++){var l=[t[a][0],r*Math.pow(t[a][0],o)];e.push(l)}return{equation:[r,o],points:e,string:"y = "+Math.round(100*r)/100+"x^"+Math.round(100*o)/100}},polynomial:function(t,i){void 0===i&&(i=2);for(var e=[],o=[],r=[],a=0,u=0,l=0,s=i+1;l<s;l++){for(var h=0,d=t.length;h<d;h++)null!=t[h][1]&&(a+=Math.pow(t[h][0],l)*t[h][1]);e.push(a),a=0;for(var f=[],c=0;c<s;c++){for(var h=0,d=t.length;h<d;h++)null!=t[h][1]&&(u+=Math.pow(t[h][0],l+c));f.push(u),u=0}o.push(f)}o.push(e);for(var p=n(o,s),l=0,d=t.length;l<d;l++){for(var v=0,g=0;g<p.length;g++)v+=p[g]*Math.pow(t[l][0],g);r.push([t[l][0],v])}for(var x="y = ",l=p.length-1;l>=0;l--)x+=l>1?Math.round(p[l]*Math.pow(10,l))/Math.pow(10,l)+"x^"+l+" + ":1==l?Math.round(100*p[l])/100+"x + ":Math.round(100*p[l])/100;return{equation:p,points:r,string:x}},lastvalue:function t(n){for(var i=[],t=null,e=0;e<n.length;e++)n[e][1]?(t=n[e][1],i.push([n[e][0],n[e][1]])):i.push([n[e][0],t]);return{equation:[t],points:i,string:""+t}}},e={model:function(t,n,e){if("string"==typeof t)return i[t](n,e)},fit:function(t,n){var i=0,e=1;if(!t)return Number.MAX_VALUE;for(var o=0;o<t.length;++o)i+=t[o]*e,e*=n;return i}};t.exports=e}()},function(t,n,i){"use strict";function e(t){var n=1.2*g.lineHeight,i=1.75*g.lineSpacing,e=Number.NaN;Math.abs(t)<n?e=0:t>0&&t<i?e=1:t<0&&(e=Math.round(t/g.lineSpacing)),v.push(Number.isNaN(e)?"chaotic jump":"line changed by "+e);var o=null;if(x&&!Number.isNaN(e)){var r=x.index+e;r>=0&&r<g.lines.length?(o=g.lines[r],v.push("line #",o.index)):v.push("jump outside the line")}else o=!1,v.push("cannot estimate line from saccade");return o}function o(t){var n=.5*g.lineSpacing,i=g.lines.find(function(i){var e=Math.abs(t.y-i.center.y);return(t.x<i.left?i.left-t.x:t.x>i.right?t.x-i.right:0)<200&&e<n});return i?v.push("line #",i.index):v.push("the fixation is not on any line"),i}function r(t){var n=t.y-x.center.y;return v.push("checking the Y offset",n),g.lines.find(function(t){if(!t.fixations.length)return!1;var i=t.center.y;v.push("    ly =",i);var e=t.fixations.reduce(function(t,n){return v.push("    :",n[1]-i),t+(n[1]-i)},0)/t.fixations.length;return v.push("    d = ",e),void 0!==e&&(n<e-g.lineHeight||n>e+g.lineHeight)})?(v.push("the line is too far, mapping naively"),o(t)):x}function a(t){if(!x)return null;x.addFixation(t),t.line=x.index;for(var n=t.x,i=null,e=Number.MAX_VALUE,o=x.words,r=0;r<o.length;++r){var a=o[r],u=a.rect,l=n<u.left?u.left-n:n>u.right?n-u.right:0;if(l<e&&(i=a,e=l,0===l))break}return t.word=i,i&&m.onMapped&&m.onMapped(t),v.push("[d=",Math.floor(e),"]",i?i.line.index+","+i.index:""),i}var u=i(0),l=i(1).Line,s=i(3),h=i(2),d={init:function(t){t=t||{},f=t.dgwm||{},l.init(t.line),s.init(t.textModel),c=h.Detector,c.init(t.fixationDetector),p=u.forModule("DGWM")},feedFixation:function(t){if(t)return y=t,v=p.start("--- fix ---"),v.push(""+t),x=e(t.saccade.y),x=x?r(t):o(t),M=a(t),p.end(v),M?M.dom:null},feed:function(t,n,i){var e=null;g=s.create(t);var o=c.feed(n,i);return o?e=this.feedFixation(o):y=null,e},reset:function(t){s.reset(),c.reset(),x=null,M=null,y=null,g=null,t&&(g=s.create(t))},callbacks:function(t){if(!t)return m;m.onMapped=t.onMapped},currentWord:function(){return M},mappedFix:function(){return y}},f=void 0,c=void 0,p=void 0,v=void 0,g=void 0,x=void 0,M=void 0,y=void 0,m={onMapped:null};t.exports=d}]);